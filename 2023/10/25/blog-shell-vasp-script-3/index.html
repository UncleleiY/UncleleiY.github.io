

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;dark&#34;>



    <head>
        <meta charset="UTF-8">
        <!-- 通过cdn引入霞鹜文楷字体 -->
        <link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-screen-webfont/style.css" media="print" onload="this.media='all'">
        <link rel="apple-touch-icon" sizes="76x76" href="/img/self.gif">
        <link rel="icon" type="image/png" href="/img/self.gif">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <!-- 谷歌广告 -->
        <script data-ad-client="ca-pub-2387054913975173" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
        </script>
        
                <meta name="baidu-site-verification" content="code-PdLAgt4JZr">
                <meta name="theme-color" content="#2f4154">
                <meta name="description" content="天行健，君子以自强不息；地势坤，君子以厚德载物">
                <meta name="author" content="Uncle_yang">
                <meta name="keywords" content="知识、管理">
                <title>
                    shell脚本：查看任务执行 - 诗意の理性
                </title>

                <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/gradient-dark.min.css" />
    
  

  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->

  
<link rel="stylesheet" href="/css/csdn.css">
<link rel="stylesheet" href="/css/red.css">
<link rel="stylesheet" href="/css/new.css">



                    <script  src="/js/utils.js" ></script>
                        <script  src="/js/color-schema.js" ></script>
    <meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="诗意の理性" type="application/atom+xml">
</head>


<body>
  <header style="height: 100vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Uncle-yang</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner intro-2" id="background" false
         style="background: url('/null') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0)">
          <div class="container page-header text-center fade-in-up">
            <span class="h2" id="subtitle">
              
                shell脚本：查看任务执行
              
            </span>

            
              <div class="mt-3">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-author" aria-hidden="true"></i>
      Uncle_yang
    </span>
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2023-10-25 12:00" pubdate>
        2023年10月25日 中午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      3k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      59
       分钟
    </span>
  

  
  
    
      <!-- 不蒜子统计文章PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> 次
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto" id="post">
            <!-- SEO header -->
            <h1 style="display: none">shell脚本：查看任务执行</h1>
            
            <div class="markdown-body" id="post-body">
              <p>网上收集的一些脚本经过魔改，以及自己写的一小部分脚本，用于实现：</p>
<ul>
<li>查看结构优化过程中能量和力的变化</li>
<li>查看结构优化过程中晶格参数的变化</li>
<li>清理结构优化之后其他不常用的文件</li>
<li>监控超算任务执行的相关情况</li>
</ul>
<div class="hljs"><pre><code class="hljs sh"><span class="hljs-meta">#!/bin/bash</span>

<span class="hljs-comment">########################################&lt;&lt;&lt;&lt;energy-force&gt;&gt;&gt;&gt;#####################################</span>
<span class="hljs-function"><span class="hljs-title">f01</span></span>()&#123;
<span class="hljs-comment">#!/bin/bash</span>

<span class="hljs-comment"># choose ion steps to eliminate forces of fixed atoms</span>
<span class="hljs-built_in">read</span> -p <span class="hljs-string">&quot;Choose Ion Steps: &quot;</span> steps

<span class="hljs-comment"># plot energies of structure in optimization</span>
awk <span class="hljs-string">&#x27;/E0/&#123;if ( i&lt;=5 ) i++;else print $0 &#125;&#x27;</span> OSZICAR &gt;temp.e
gnuplot &lt;&lt;<span class="hljs-string">EOF</span>
<span class="hljs-string">set term dumb</span>
<span class="hljs-string">set title &#x27;Energy of each ion steps (OSZICAR)&#x27;</span>
<span class="hljs-string">set xlabel &#x27;Ion steps&#x27;</span>
<span class="hljs-string">set ylabel &#x27;Energy(eV)&#x27;</span>
<span class="hljs-string">plot &#x27;temp.e&#x27; u 1:5 w l</span>
<span class="hljs-string">EOF</span>
<span class="hljs-built_in">rm</span> temp.e

<span class="hljs-comment"># eliminate forces of fixed atoms</span>
fix=<span class="hljs-variable">$1</span>
<span class="hljs-keyword">if</span> <span class="hljs-built_in">test</span> -z <span class="hljs-variable">$1</span>; <span class="hljs-keyword">then</span>
fix=0
<span class="hljs-keyword">fi</span>
<span class="hljs-comment"># get force form OUTCAR</span>
awk -v fix=<span class="hljs-string">&quot;<span class="hljs-variable">$fix</span>&quot;</span> <span class="hljs-string">&#x27;/POSITION/,/drift/&#123;</span>
<span class="hljs-string">if($1~/^[0-9.]+$/&amp;&amp;$3&gt;=fix) print $1,$2,$3,sqrt($4*$4+$5*$5+$6*$6i);</span>
<span class="hljs-string">else if($1==&quot;total&quot;) print $0</span>
<span class="hljs-string">&#125;&#x27;</span> OUTCAR &gt;temp.f
awk <span class="hljs-string">&#x27;&#123;</span>
<span class="hljs-string">if($1==&quot;total&quot;) &#123;print ++i,a;a=0&#125;</span>
<span class="hljs-string">else &#123;if(a&lt;$4) a=$4&#125;</span>
<span class="hljs-string">&#125;&#x27;</span> temp.f &gt;force.conv
<span class="hljs-comment">#sed -i &#x27;1,9d&#x27; force.conv</span>
<span class="hljs-comment">#rm temp.f</span>
<span class="hljs-built_in">tail</span> -<span class="hljs-variable">$steps</span> force.conv &gt;temp.f

<span class="hljs-comment">#plot</span>
gnuplot &lt;&lt;<span class="hljs-string">EOF</span>
<span class="hljs-string">set term dumb</span>
<span class="hljs-string">set title &#x27;Max force of each ion steps (EDIFFG)&#x27;</span>
<span class="hljs-string">set xlabel &#x27;Ion steps&#x27;</span>
<span class="hljs-string">set ylabel &#x27;Force (eV/Angstrom)&#x27;</span>
<span class="hljs-string">plot &#x27;temp.f&#x27; w l t &quot; Force &quot;</span>
<span class="hljs-string">EOF</span>
<span class="hljs-built_in">rm</span> force.conv  temp.f
&#125;
<span class="hljs-comment">########################################&lt;&lt;&lt;&lt;energy-force&gt;&gt;&gt;&gt;#####################################</span>

<span class="hljs-comment">#########################################&lt;&lt;&lt;&lt;lattice-script&gt;&gt;&gt;&gt;##################################</span>
<span class="hljs-function"><span class="hljs-title">f02</span></span>()&#123;
<span class="hljs-comment">#!/bin/bash</span>

<span class="hljs-comment">#Purpose: compare lattice constant between POSCAR and CONTCAR.</span>

dos2unix POSCAR

<span class="hljs-comment">#lattice constant components from POSCAR without scaling</span>
scale_posc=$(awk <span class="hljs-string">&#x27;NR==2 &#123;print $1&#125;&#x27;</span> POSCAR)
x1_posc=$(awk <span class="hljs-string">&#x27;NR==3 &#123;print $1&#125;&#x27;</span> POSCAR)
x2_posc=$(awk <span class="hljs-string">&#x27;NR==3 &#123;print $2&#125;&#x27;</span> POSCAR)
x3_posc=$(awk <span class="hljs-string">&#x27;NR==3 &#123;print $3&#125;&#x27;</span> POSCAR)
y1_posc=$(awk <span class="hljs-string">&#x27;NR==4 &#123;print $1&#125;&#x27;</span> POSCAR)
y2_posc=$(awk <span class="hljs-string">&#x27;NR==4 &#123;print $2&#125;&#x27;</span> POSCAR)
y3_posc=$(awk <span class="hljs-string">&#x27;NR==4 &#123;print $3&#125;&#x27;</span> POSCAR)
z1_posc=$(awk <span class="hljs-string">&#x27;NR==5 &#123;print $1&#125;&#x27;</span> POSCAR)
z2_posc=$(awk <span class="hljs-string">&#x27;NR==5 &#123;print $2&#125;&#x27;</span> POSCAR)
z3_posc=$(awk <span class="hljs-string">&#x27;NR==5 &#123;print $3&#125;&#x27;</span> POSCAR)
<span class="hljs-comment">#lattice constant from POSCAR without scaling</span>
xL_posc=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;scale=4;(sqrt(&quot;</span><span class="hljs-variable">$x1_posc</span><span class="hljs-string">&quot;^2 + &quot;</span><span class="hljs-variable">$x2_posc</span><span class="hljs-string">&quot;^2 + &quot;</span><span class="hljs-variable">$x3_posc</span><span class="hljs-string">&quot;^2) * &quot;</span><span class="hljs-variable">$scale_posc</span><span class="hljs-string">&quot;/1)&quot;</span> |bc)
yL_posc=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;scale=4;(sqrt(&quot;</span><span class="hljs-variable">$y1_posc</span><span class="hljs-string">&quot;^2 + &quot;</span><span class="hljs-variable">$y2_posc</span><span class="hljs-string">&quot;^2 + &quot;</span><span class="hljs-variable">$y3_posc</span><span class="hljs-string">&quot;^2) * &quot;</span><span class="hljs-variable">$scale_posc</span><span class="hljs-string">&quot;/1)&quot;</span> |bc)
zL_posc=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;scale=4;(sqrt(&quot;</span><span class="hljs-variable">$z1_posc</span><span class="hljs-string">&quot;^2 + &quot;</span><span class="hljs-variable">$z2_posc</span><span class="hljs-string">&quot;^2 + &quot;</span><span class="hljs-variable">$z3_posc</span><span class="hljs-string">&quot;^2) * &quot;</span><span class="hljs-variable">$scale_posc</span><span class="hljs-string">&quot;/1)&quot;</span> |bc)

<span class="hljs-comment">#lattice constant components from CONTCAR without scaling</span>
scale_cont=$(awk <span class="hljs-string">&#x27;NR==2 &#123;print $1&#125;&#x27;</span> CONTCAR)
x1_cont=$(awk <span class="hljs-string">&#x27;NR==3 &#123;print $1&#125;&#x27;</span> CONTCAR)
x2_cont=$(awk <span class="hljs-string">&#x27;NR==3 &#123;print $2&#125;&#x27;</span> CONTCAR)
x3_cont=$(awk <span class="hljs-string">&#x27;NR==3 &#123;print $3&#125;&#x27;</span> CONTCAR)
y1_cont=$(awk <span class="hljs-string">&#x27;NR==4 &#123;print $1&#125;&#x27;</span> CONTCAR)
y2_cont=$(awk <span class="hljs-string">&#x27;NR==4 &#123;print $2&#125;&#x27;</span> CONTCAR)
y3_cont=$(awk <span class="hljs-string">&#x27;NR==4 &#123;print $3&#125;&#x27;</span> CONTCAR)
z1_cont=$(awk <span class="hljs-string">&#x27;NR==5 &#123;print $1&#125;&#x27;</span> CONTCAR)
z2_cont=$(awk <span class="hljs-string">&#x27;NR==5 &#123;print $2&#125;&#x27;</span> CONTCAR)
z3_cont=$(awk <span class="hljs-string">&#x27;NR==5 &#123;print $3&#125;&#x27;</span> CONTCAR)
<span class="hljs-comment">#lattice constant from CONTCAR without scaling</span>
xL_cont=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;scale=4;(sqrt(&quot;</span><span class="hljs-variable">$x1_cont</span><span class="hljs-string">&quot;^2 + &quot;</span><span class="hljs-variable">$x2_cont</span><span class="hljs-string">&quot;^2 + &quot;</span><span class="hljs-variable">$x3_cont</span><span class="hljs-string">&quot;^2) * &quot;</span><span class="hljs-variable">$scale_cont</span><span class="hljs-string">&quot;/1)&quot;</span> |bc)
yL_cont=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;scale=4;(sqrt(&quot;</span><span class="hljs-variable">$y1_cont</span><span class="hljs-string">&quot;^2 + &quot;</span><span class="hljs-variable">$y2_cont</span><span class="hljs-string">&quot;^2 + &quot;</span><span class="hljs-variable">$y3_cont</span><span class="hljs-string">&quot;^2) * &quot;</span><span class="hljs-variable">$scale_cont</span><span class="hljs-string">&quot;/1)&quot;</span> |bc)
zL_cont=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;scale=4;(sqrt(&quot;</span><span class="hljs-variable">$z1_cont</span><span class="hljs-string">&quot;^2 + &quot;</span><span class="hljs-variable">$z2_cont</span><span class="hljs-string">&quot;^2 + &quot;</span><span class="hljs-variable">$z3_cont</span><span class="hljs-string">&quot;^2) * &quot;</span><span class="hljs-variable">$scale_cont</span><span class="hljs-string">&quot;/1)&quot;</span> |bc)

<span class="hljs-comment">#diff: in unit of percentage, subt: in unit of angstrom </span>
j=1
refer_num=0.001
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> x1 x2 x3 y1 y2 y3 z1 z2 z3 ; <span class="hljs-keyword">do</span>
        flag1=<span class="hljs-variable">$i</span>\_posc
        posc_flag=$(<span class="hljs-built_in">eval</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;$&#x27;</span><span class="hljs-string">&quot;<span class="hljs-variable">$flag1</span>&quot;</span>)
        flag2=<span class="hljs-variable">$i</span>\_cont
        cont_flag=$(<span class="hljs-built_in">eval</span> <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;$&#x27;</span><span class="hljs-string">&quot;<span class="hljs-variable">$flag2</span>&quot;</span>)
        <span class="hljs-keyword">if</span> [ $( <span class="hljs-built_in">expr</span> <span class="hljs-variable">$posc_flag</span> \&gt; <span class="hljs-variable">$refer_num</span> ) -eq 0 ] ; <span class="hljs-keyword">then</span>
                diff[<span class="hljs-variable">$j</span>]=--
        <span class="hljs-keyword">else</span>
                diff[<span class="hljs-variable">$j</span>]=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;scale=4;((&quot;</span><span class="hljs-variable">$posc_flag</span><span class="hljs-string">&quot; * &quot;</span><span class="hljs-variable">$scale_posc</span><span class="hljs-string">&quot; - &quot;</span><span class="hljs-variable">$cont_flag</span><span class="hljs-string">&quot; * &quot;</span><span class="hljs-variable">$scale_cont</span><span class="hljs-string">&quot;) / &quot;</span><span class="hljs-variable">$posc_flag</span><span class="hljs-string">&quot; / &quot;</span><span class="hljs-variable">$scale_posc</span><span class="hljs-string">&quot; * 100)&quot;</span> |bc)
        <span class="hljs-keyword">fi</span>
        subt[<span class="hljs-variable">$j</span>]=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;scale=4;((&quot;</span><span class="hljs-variable">$posc_flag</span><span class="hljs-string">&quot; * &quot;</span><span class="hljs-variable">$scale_posc</span><span class="hljs-string">&quot; - &quot;</span><span class="hljs-variable">$cont_flag</span><span class="hljs-string">&quot; * &quot;</span><span class="hljs-variable">$scale_cont</span><span class="hljs-string">&quot;) / 1)&quot;</span> |bc)
        j=$( <span class="hljs-built_in">expr</span> <span class="hljs-variable">$j</span> + 1)
<span class="hljs-keyword">done</span>

xL_diff=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;scale=4;((&quot;</span><span class="hljs-variable">$xL_posc</span><span class="hljs-string">&quot; - &quot;</span><span class="hljs-variable">$xL_cont</span><span class="hljs-string">&quot;) / &quot;</span><span class="hljs-variable">$xL_posc</span><span class="hljs-string">&quot; * 100)&quot;</span> |bc)
yL_diff=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;scale=4;((&quot;</span><span class="hljs-variable">$yL_posc</span><span class="hljs-string">&quot; - &quot;</span><span class="hljs-variable">$yL_cont</span><span class="hljs-string">&quot;) / &quot;</span><span class="hljs-variable">$yL_posc</span><span class="hljs-string">&quot; * 100)&quot;</span> |bc)
zL_diff=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;scale=4;((&quot;</span><span class="hljs-variable">$zL_posc</span><span class="hljs-string">&quot; - &quot;</span><span class="hljs-variable">$zL_cont</span><span class="hljs-string">&quot;) / &quot;</span><span class="hljs-variable">$zL_posc</span><span class="hljs-string">&quot; * 100)&quot;</span> |bc)

xL_subt=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;scale=4;((&quot;</span><span class="hljs-variable">$xL_posc</span><span class="hljs-string">&quot; - &quot;</span><span class="hljs-variable">$xL_cont</span><span class="hljs-string">&quot;) / 1)&quot;</span> |bc)
yL_subt=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;scale=4;((&quot;</span><span class="hljs-variable">$yL_posc</span><span class="hljs-string">&quot; - &quot;</span><span class="hljs-variable">$yL_cont</span><span class="hljs-string">&quot;) / 1)&quot;</span> |bc)
zL_subt=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;scale=4;((&quot;</span><span class="hljs-variable">$zL_posc</span><span class="hljs-string">&quot; - &quot;</span><span class="hljs-variable">$zL_cont</span><span class="hljs-string">&quot;) / 1)&quot;</span> |bc)

<span class="hljs-comment"># mv lattice-difference lattice-difference.before</span>
<span class="hljs-built_in">echo</span> &gt;&gt; lattice-difference
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;I am in <span class="hljs-variable">$PWD</span>&quot;</span> &gt;&gt; lattice-difference
<span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;======== the difference of lattice constant between POSCAR and CONTCAR ========&#x27;</span> &gt;&gt; lattice-difference
<span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %12s\t %12s\t %12s\t %12s\t \n&#x27;</span> $(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;diff(%)  component1  component2  component3  Total&quot;</span>)     &gt;&gt; lattice-difference
<span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %12s\t %12s\t %12s\t %12s\t \n&#x27;</span> $(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;======== ==========  ==========  ==========  ========&quot;</span>)  &gt;&gt; lattice-difference
<span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %12s\t %12s\t %12s\t %12s\t \n&#x27;</span> $(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;X_axis   <span class="hljs-variable">$&#123;diff[1]&#125;</span>% <span class="hljs-variable">$&#123;diff[2]&#125;</span>% <span class="hljs-variable">$&#123;diff[3]&#125;</span>% <span class="hljs-variable">$xL_diff</span>%&quot;</span>) &gt;&gt; lattice-difference
<span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %12s\t %12s\t %12s\t %12s\t \n&#x27;</span> $(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Y_axis   <span class="hljs-variable">$&#123;diff[4]&#125;</span>% <span class="hljs-variable">$&#123;diff[5]&#125;</span>% <span class="hljs-variable">$&#123;diff[6]&#125;</span>% <span class="hljs-variable">$yL_diff</span>%&quot;</span>) &gt;&gt; lattice-difference
<span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %12s\t %12s\t %12s\t %12s\t \n&#x27;</span> $(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Z_axis   <span class="hljs-variable">$&#123;diff[7]&#125;</span>% <span class="hljs-variable">$&#123;diff[8]&#125;</span>% <span class="hljs-variable">$&#123;diff[9]&#125;</span>% <span class="hljs-variable">$zL_diff</span>%&quot;</span>) &gt;&gt; lattice-difference
<span class="hljs-built_in">echo</span> &gt;&gt; lattice-difference
<span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %12s\t %12s\t %12s\t %12s\t \n&#x27;</span> $(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;subt(A)  component1   component2   component3   Total&quot;</span>)     &gt;&gt; lattice-difference
<span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %12s\t %12s\t %12s\t %12s\t \n&#x27;</span> $(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;======== ==========   ==========   ==========   ========&quot;</span>)  &gt;&gt; lattice-difference
<span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %12s\t %12s\t %12s\t %12s\t \n&#x27;</span> $(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;X_axis   <span class="hljs-variable">$&#123;subt[1]&#125;</span>/A <span class="hljs-variable">$&#123;subt[2]&#125;</span>/A <span class="hljs-variable">$&#123;subt[3]&#125;</span>/A <span class="hljs-variable">$xL_subt</span>/A&quot;</span>) &gt;&gt; lattice-difference
<span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %12s\t %12s\t %12s\t %12s\t \n&#x27;</span> $(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Y_axis   <span class="hljs-variable">$&#123;subt[4]&#125;</span>/A <span class="hljs-variable">$&#123;subt[5]&#125;</span>/A <span class="hljs-variable">$&#123;subt[6]&#125;</span>/A <span class="hljs-variable">$yL_subt</span>/A&quot;</span>) &gt;&gt; lattice-difference
<span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %12s\t %12s\t %12s\t %12s\t \n&#x27;</span> $(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Z_axis   <span class="hljs-variable">$&#123;subt[7]&#125;</span>/A <span class="hljs-variable">$&#123;subt[8]&#125;</span>/A <span class="hljs-variable">$&#123;subt[9]&#125;</span>/A <span class="hljs-variable">$zL_subt</span>/A&quot;</span>) &gt;&gt; lattice-difference
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot; &quot;</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;****************************Lattice of POSCAR****************************&quot;</span>
sed -n <span class="hljs-string">&#x27;3,5p&#x27;</span> POSCAR
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;*************************************************************************&quot;</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot; &quot;</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;****************************Lattice of CONTCAR***************************&quot;</span>
sed -n <span class="hljs-string">&#x27;3,5p&#x27;</span> CONTCAR
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;*************************************************************************&quot;</span>
<span class="hljs-built_in">cat</span> lattice-difference
<span class="hljs-built_in">rm</span> lattice-difference
&#125;
<span class="hljs-comment">###########################################&lt;&lt;&lt;&lt;lattice-script&gt;&gt;&gt;&gt;########################################</span>

<span class="hljs-comment">###########################################&lt;&lt;&lt;&lt;summary-script&gt;&gt;&gt;&gt;########################################</span>
<span class="hljs-function"><span class="hljs-title">f03</span></span>()&#123;
<span class="hljs-comment">#!/bin/bash</span>

<span class="hljs-comment">#generate comment-file after VASP calculation</span>
<span class="hljs-built_in">dir</span>=<span class="hljs-variable">$1</span>

nsw=$(grep <span class="hljs-string">&quot;NSW&quot;</span> OUTCAR | <span class="hljs-built_in">tail</span> -1 | awk <span class="hljs-string">&#x27;&#123;print $3&#125;&#x27;</span>)
E0=$(grep <span class="hljs-string">&quot;without&quot;</span> OUTCAR |<span class="hljs-built_in">tail</span> -1| awk <span class="hljs-string">&#x27;&#123;printf &quot;%12.6f \n&quot;, $7&#125;&#x27;</span>)
EENTRO=$(grep <span class="hljs-string">&quot;EENTRO&quot;</span> OUTCAR |<span class="hljs-built_in">tail</span> -1| awk <span class="hljs-string">&#x27;&#123;printf &quot;%12.6f \n&quot;, $5&#125;&#x27;</span>)
Edisp=$(grep <span class="hljs-string">&quot;Edisp&quot;</span> OUTCAR |<span class="hljs-built_in">tail</span> -1| awk <span class="hljs-string">&#x27;&#123;printf &quot;%12.5f \n&quot;, $3&#125;&#x27;</span>)
MAGNE=$(grep <span class="hljs-string">&quot;mag&quot;</span> OSZICAR |<span class="hljs-built_in">tail</span> -1| awk <span class="hljs-string">&#x27;&#123;printf &quot;%12.4f \n&quot;, $10&#125;&#x27;</span>)
require=$(grep <span class="hljs-string">&quot;require&quot;</span> OUTCAR | awk <span class="hljs-string">&#x27;&#123;printf &quot;%s \n&quot;, $1&#125;&#x27;</span>)
dE=$(grep <span class="hljs-string">&quot;E&quot;</span> OSZICAR |<span class="hljs-built_in">tail</span> -2|<span class="hljs-built_in">head</span> -1| awk <span class="hljs-string">&#x27;&#123;printf &quot;%s \n&quot;, $4&#125;&#x27;</span>)
pressure=$(grep <span class="hljs-string">&quot;external&quot;</span> OUTCAR |<span class="hljs-built_in">tail</span> -1| awk <span class="hljs-string">&#x27;&#123;printf &quot;%12.2f \n&quot;, $4&#125;&#x27;</span>)
Pullay=$(grep <span class="hljs-string">&quot;external&quot;</span> OUTCAR |<span class="hljs-built_in">tail</span> -1| awk <span class="hljs-string">&#x27;&#123;printf &quot;%12.2f \n&quot;, $9&#125;&#x27;</span>)
Time=$(grep <span class="hljs-string">&quot;Elapsed&quot;</span> OUTCAR |<span class="hljs-built_in">tail</span> -1| awk <span class="hljs-string">&#x27;&#123;printf &quot;%12.0f \n&quot;, $4&#125;&#x27;</span>)

sta_sym=$(grep <span class="hljs-string">&quot;static configuration&quot;</span> OUTCAR | awk <span class="hljs-string">&#x27;&#123;printf &quot;%s \n&quot;, $8&#125;&#x27;</span>)
dyn_sym=$(grep <span class="hljs-string">&quot;dynamic configuration&quot;</span> OUTCAR | awk <span class="hljs-string">&#x27;&#123;printf &quot;%s \n&quot;, $8&#125;&#x27;</span>)
mag_sym=$(grep <span class="hljs-string">&quot;magnetic configuration&quot;</span> OUTCAR | awk <span class="hljs-string">&#x27;&#123;printf &quot;%s \n&quot;, $8&#125;&#x27;</span>)

<span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$Edisp</span>&quot;</span> = <span class="hljs-string">&quot;&quot;</span> ] ; <span class="hljs-keyword">then</span>
        Edisp=--
<span class="hljs-keyword">else</span>
        a=a
<span class="hljs-keyword">fi</span>

<span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$MAGNE</span>&quot;</span> = <span class="hljs-string">&quot;&quot;</span> ] ; <span class="hljs-keyword">then</span>
        MAGNE=--
<span class="hljs-keyword">else</span>
        a=a
<span class="hljs-keyword">fi</span>

<span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$require</span>&quot;</span> = <span class="hljs-string">&quot;&quot;</span> ] ; <span class="hljs-keyword">then</span>
        require=o_o
<span class="hljs-keyword">else</span>
        a=a
<span class="hljs-keyword">fi</span>

<span class="hljs-built_in">echo</span> ====================<span class="hljs-variable">$dir</span>==================== &gt; comment-<span class="hljs-variable">$dir</span>
<span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$nsw</span>&quot;</span> = <span class="hljs-string">&quot;0&quot;</span> ] ; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t \n&#x27;</span> `<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;E0       EENTRO   dE       pressure time     MAGNE    Edisp    Pullay&quot;</span>` &gt;&gt;comment-<span class="hljs-variable">$dir</span>
        <span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t \n&#x27;</span> `<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;======== ======== ======== ======== ======== ======== ======== ========&quot;</span>` &gt;&gt;comment-<span class="hljs-variable">$dir</span>
        <span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t \n&#x27;</span> `<span class="hljs-built_in">echo</span> <span class="hljs-variable">$E0</span>           <span class="hljs-variable">$EENTRO</span>  <span class="hljs-variable">$dE</span>      <span class="hljs-variable">$pressure</span> <span class="hljs-variable">$Time</span>       <span class="hljs-variable">$MAGNE</span>   <span class="hljs-variable">$Edisp</span>   <span class="hljs-variable">$Pullay</span>` &gt;&gt;comment-<span class="hljs-variable">$dir</span>

    <span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t \n&#x27;</span> `<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;sta_sym  dyn_sym  mag_sym  xxxxxxxx xxxxxxxx xxxxxxxx xxxxxxxx xxxxxxxx&quot;</span>` &gt;&gt;comment-<span class="hljs-variable">$dir</span>
        <span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t \n&#x27;</span> `<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;======== ======== ======== ======== ======== ======== ======== ========&quot;</span>` &gt;&gt;comment-<span class="hljs-variable">$dir</span>
        <span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t \n&#x27;</span> `<span class="hljs-built_in">echo</span> <span class="hljs-variable">$sta_sym</span>  <span class="hljs-variable">$dyn_sym</span> <span class="hljs-variable">$mag_sym</span> ` &gt;&gt;comment-<span class="hljs-variable">$dir</span>
    
    
<span class="hljs-keyword">else</span>
        <span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t \n&#x27;</span> `<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;E0       EENTRO   require  pressure time     MAGNE    Edisp    Pullay&quot;</span>` &gt;&gt;comment-<span class="hljs-variable">$dir</span>
        <span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t \n&#x27;</span> `<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;======== ======== ======== ======== ======== ======== ======== ========&quot;</span>` &gt;&gt;comment-<span class="hljs-variable">$dir</span>
        <span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t \n&#x27;</span> `<span class="hljs-built_in">echo</span> <span class="hljs-variable">$E0</span>           <span class="hljs-variable">$EENTRO</span>  <span class="hljs-variable">$require</span> <span class="hljs-variable">$pressure</span> <span class="hljs-variable">$Time</span>   <span class="hljs-variable">$MAGNE</span>   <span class="hljs-variable">$Edisp</span>   <span class="hljs-variable">$Pullay</span>` &gt;&gt;comment-<span class="hljs-variable">$dir</span>
 
    <span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t \n&#x27;</span> `<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;sta_sym  dyn_sym  mag_sym  xxxxxxxx xxxxxxxx xxxxxxxx xxxxxxxx xxxxxxxx&quot;</span>` &gt;&gt;comment-<span class="hljs-variable">$dir</span>
        <span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t \n&#x27;</span> `<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;======== ======== ======== ======== ======== ======== ======== ========&quot;</span>` &gt;&gt;comment-<span class="hljs-variable">$dir</span>
        <span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t %10s\t \n&#x27;</span> `<span class="hljs-built_in">echo</span> <span class="hljs-variable">$sta_sym</span>  <span class="hljs-variable">$dyn_sym</span> <span class="hljs-variable">$mag_sym</span> ` &gt;&gt;comment-<span class="hljs-variable">$dir</span>
<span class="hljs-keyword">fi</span>

<span class="hljs-built_in">cat</span> comment-
<span class="hljs-built_in">rm</span> comment-
&#125;
<span class="hljs-comment">###########################################&lt;&lt;&lt;&lt;summary-script&gt;&gt;&gt;&gt;########################################</span>

<span class="hljs-comment">#############################################&lt;&lt;&lt;&lt;mag-script&gt;&gt;&gt;&gt;##########################################</span>
<span class="hljs-function"><span class="hljs-title">f04</span></span>()&#123;
<span class="hljs-comment">#!/bin/bash</span>

<span class="hljs-comment">#=====================================</span>
<span class="hljs-comment"># HOW TO USE : ./gene-mag.sh</span>
<span class="hljs-comment"># extracting total and local magnetization information from OSZICAR and OUTCAR</span>
<span class="hljs-comment"># read file: POSCAR, OUTCAR, OSZICAR</span>
<span class="hljs-comment">#=====================================</span>

<span class="hljs-comment">#==== get dir ====</span>
<span class="hljs-built_in">dir</span>=$(<span class="hljs-built_in">basename</span> `<span class="hljs-built_in">pwd</span>`)
<span class="hljs-built_in">echo</span> ---- <span class="hljs-built_in">dir</span>=<span class="hljs-variable">$dir</span> ----         &gt; magne_atom.dat
<span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %10s\t \n&#x27;</span> `<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;atom_nam  atom_mag&quot;</span>`   &gt;  magne.tmp
<span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %10s\t \n&#x27;</span> `<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;========  ========&quot;</span>`   &gt;&gt; magne.tmp

ispin=$(grep ISPIN OUTCAR | awk <span class="hljs-string">&#x27;&#123;print $3&#125;&#x27;</span>)

<span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$ispin</span>&quot;</span> = 2 ] ; <span class="hljs-keyword">then</span>

<span class="hljs-comment">#==== get atom_num ====</span>
    num_tot=0
    i_flag=0
    atom_num=
    atom_lis=
    <span class="hljs-keyword">for</span> i_atom <span class="hljs-keyword">in</span> $(sed -n <span class="hljs-string">&#x27;6p&#x27;</span> POSCAR) ; <span class="hljs-keyword">do</span>
        
        i_flag=$[ i_flag + 1 ]
        j_flag=0
    <span class="hljs-comment">#echo i_atom=$i_atom    i_flag=$i_flag</span>
        <span class="hljs-keyword">for</span> j_num <span class="hljs-keyword">in</span> $(sed -n <span class="hljs-string">&#x27;7p&#x27;</span> POSCAR) ; <span class="hljs-keyword">do</span>
            j_flag=$[ j_flag + 1 ]
    <span class="hljs-comment">#echo j_num=$j_num      j_flag=$j_flag</span>
    
            <span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$i_flag</span>&quot;</span> -eq <span class="hljs-string">&quot;<span class="hljs-variable">$j_flag</span>&quot;</span> ] ; <span class="hljs-keyword">then</span>
                atom_num=<span class="hljs-variable">$atom_num</span>\ <span class="hljs-variable">$i_atom</span>\_<span class="hljs-variable">$j_num</span>
                num_tot=$[ num_tot + j_num ]
    
                <span class="hljs-keyword">for</span> k_elem <span class="hljs-keyword">in</span> $(<span class="hljs-built_in">seq</span> 1 <span class="hljs-variable">$j_num</span>) ; <span class="hljs-keyword">do</span>
                   atom_lis=<span class="hljs-variable">$atom_lis</span>\ <span class="hljs-variable">$i_atom</span>
    <span class="hljs-comment">#echo i_atom=$i_atom</span>
                <span class="hljs-keyword">done</span>
    
            <span class="hljs-keyword">fi</span>
        <span class="hljs-keyword">done</span>
    <span class="hljs-keyword">done</span>
<span class="hljs-comment">#==== get mag_tota ====</span>
    mag_tota=$(grep <span class="hljs-string">&quot;mag&quot;</span> OSZICAR |<span class="hljs-built_in">tail</span> -1| awk <span class="hljs-string">&#x27;&#123;printf &quot;%12.4f \n&quot;, $10&#125;&#x27;</span>)
    
<span class="hljs-comment">#==== get mag_atom ====    </span>
    start_line=$(grep -n <span class="hljs-string">&#x27;magnetization (x)&#x27;</span> OUTCAR | <span class="hljs-built_in">cut</span> -d <span class="hljs-string">&quot;:&quot;</span> -f 1 | <span class="hljs-built_in">tail</span> -1)
    mag_atom=
    mag_flag=0
    <span class="hljs-keyword">for</span> i_line <span class="hljs-keyword">in</span> $(<span class="hljs-built_in">seq</span> 1 <span class="hljs-variable">$num_tot</span>) ; <span class="hljs-keyword">do</span>
        line_num=$[ start_line + 3 + i_line ]
        mag=$(awk <span class="hljs-string">&#x27;NR==&#x27;</span><span class="hljs-variable">$line_num</span><span class="hljs-string">&#x27;&#123;print $5&#125;&#x27;</span> OUTCAR)
        mag_atom=<span class="hljs-variable">$mag_atom</span>\ <span class="hljs-variable">$mag</span>
        atom_nam=$( <span class="hljs-built_in">echo</span> <span class="hljs-variable">$atom_lis</span> | <span class="hljs-built_in">cut</span> -d <span class="hljs-string">&quot; &quot;</span> -f <span class="hljs-variable">$i_line</span> )
    
        <span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-subst">$( echo <span class="hljs-string">&quot; ( <span class="hljs-variable">$mag</span> &lt; 0.01) &amp;&amp; ( <span class="hljs-variable">$mag</span> &gt; -0.01 )&quot;</span> |bc)</span>&quot;</span> = 1 ] ; <span class="hljs-keyword">then</span>
            mag_flag=$[ mag_flag + 1 ]
        <span class="hljs-keyword">fi</span>
        
        <span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %10s\t \n&#x27;</span> `<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$atom_nam</span>  <span class="hljs-variable">$mag</span>&quot;</span>`      &gt;&gt; magne.tmp
    
    <span class="hljs-keyword">done</span>
    
    <span class="hljs-built_in">echo</span> mag_flag=<span class="hljs-variable">$mag_flag</span> num_tot=<span class="hljs-variable">$num_tot</span>
        <span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$mag_flag</span>&quot;</span> -eq <span class="hljs-string">&quot;<span class="hljs-variable">$num_tot</span>&quot;</span> ] ; <span class="hljs-keyword">then</span>
            ispin=1
        <span class="hljs-keyword">else</span>
            ispin=2
        <span class="hljs-keyword">fi</span>
    
    <span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %10s\t \n&#x27;</span> `<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;--------  --------&quot;</span>`   &gt;&gt; magne_atom.dat
    <span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %10s\t \n&#x27;</span> `<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;mag_tota  <span class="hljs-variable">$mag_tota</span>&quot;</span>`  &gt;&gt; magne_atom.dat

<span class="hljs-keyword">fi</span>
    <span class="hljs-built_in">printf</span> <span class="hljs-string">&#x27;%10s\t %10s\t \n&#x27;</span> `<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ISPIN=    <span class="hljs-variable">$ispin</span>&quot;</span>`     &gt;&gt; magne_atom.dat
        <span class="hljs-built_in">cat</span> magne.tmp &gt;&gt; magne_atom.dat

<span class="hljs-built_in">cat</span> magne.tmp
<span class="hljs-built_in">cat</span> magne_atom.dat
<span class="hljs-built_in">rm</span> magne.tmp
<span class="hljs-built_in">rm</span> magne_atom.dat
&#125;
<span class="hljs-comment">#############################################&lt;&lt;&lt;&lt;mag-script&gt;&gt;&gt;&gt;##########################################</span>

<span class="hljs-comment">#############################################&lt;&lt;&lt;&lt;sort-script&gt;&gt;&gt;&gt;#########################################</span>
<span class="hljs-function"><span class="hljs-title">f05</span></span>()&#123;
<span class="hljs-comment">#!/bin/bash</span>

<span class="hljs-built_in">read</span> -p <span class="hljs-string">&quot;File Name : &quot;</span> names

data=$(<span class="hljs-built_in">cat</span> <span class="hljs-variable">$names</span>)

<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;*********input data*********&quot;</span>
<span class="hljs-built_in">cat</span> <span class="hljs-variable">$names</span>

<span class="hljs-comment"># 按照第一列数据大小排序</span>
sorted_data=$(<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$data</span>&quot;</span> | <span class="hljs-built_in">sort</span> -n)

<span class="hljs-comment"># 输出排序结果</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;*********output data********* &quot;</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$sorted_data</span>&quot;</span> &gt; new_<span class="hljs-variable">$names</span>
<span class="hljs-built_in">cat</span> new_<span class="hljs-variable">$names</span>
&#125;
<span class="hljs-comment">#############################################&lt;&lt;&lt;&lt;sort-script&gt;&gt;&gt;&gt;#########################################</span>

<span class="hljs-comment">##############################################&lt;&lt;&lt;&lt;job-monitor&gt;&gt;&gt;&gt;#########################################</span>
<span class="hljs-function"><span class="hljs-title">f00</span></span>()&#123;
<span class="hljs-comment">#!/bin/bash</span>
<span class="hljs-keyword">if</span> [ <span class="hljs-variable">$#</span> -lt 1 ] ; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Usage: speek [-e] [-f] jobid&quot;</span>
    <span class="hljs-built_in">echo</span> -e <span class="hljs-string">&quot; -e: show error log.\n -f: output appended data as the file grows.\n\nYour jobs are:&quot;</span>
    <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$USER</span> != <span class="hljs-string">&#x27;root&#x27;</span> ]; <span class="hljs-keyword">then</span>
        squeue -u <span class="hljs-variable">$USER</span> -t r -o <span class="hljs-string">&quot;%.8i %10P %12j %19S %.12M %.7C %.5D %R&quot;</span>
    <span class="hljs-keyword">else</span>
        squeue -t r -o <span class="hljs-string">&quot;%.8i %10u %10P %12j %19S %.12M  %.7C %.5D %R&quot;</span>
    <span class="hljs-keyword">fi</span>
    <span class="hljs-built_in">exit</span>
<span class="hljs-keyword">fi</span>
NO=1
STD=StdOut
<span class="hljs-keyword">while</span> <span class="hljs-built_in">getopts</span> <span class="hljs-string">&#x27;ef&#x27;</span> OPT; <span class="hljs-keyword">do</span>
    <span class="hljs-keyword">case</span> <span class="hljs-variable">$OPT</span> <span class="hljs-keyword">in</span>
        e)
           STD=StdErr
           ;;
        f)
           T=<span class="hljs-string">&#x27;-f&#x27;</span>
           ;;
    <span class="hljs-keyword">esac</span>
<span class="hljs-keyword">done</span>
JOBID=<span class="hljs-variable">$&#123;!#&#125;</span>
F=`scontrol show job <span class="hljs-variable">$JOBID</span> 2&gt;/dev/null | awk -v STD=<span class="hljs-variable">$STD</span> -F= <span class="hljs-string">&#x27;&#123;if($1~&#x27;</span>STD<span class="hljs-string">&#x27;) print $2&#125;&#x27;</span>`
<span class="hljs-keyword">if</span> [ -f <span class="hljs-string">&quot;<span class="hljs-variable">$F</span>&quot;</span> ]; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">tail</span> <span class="hljs-variable">$T</span> <span class="hljs-variable">$F</span>
<span class="hljs-keyword">else</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Job <span class="hljs-variable">$JOBID</span> has no <span class="hljs-variable">$STD</span> file or you have no authority to access.&quot;</span>
<span class="hljs-keyword">fi</span>
&#125;
<span class="hljs-comment">###########################################&lt;&lt;&lt;job-monitor&gt;&gt;&gt;#############################################</span>


<span class="hljs-comment">###########################################&lt;&lt;&lt;clear-some-files&gt;&gt;&gt;########################################</span>
<span class="hljs-function"><span class="hljs-title">f06</span></span>()&#123;
<span class="hljs-comment">#!/bin/bash</span>

<span class="hljs-built_in">read</span> -p <span class="hljs-string">&quot;continuely GeoOpt？(y/n) : &quot;</span> input

<span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$input</span>&quot;</span> = <span class="hljs-string">&quot;y&quot;</span> ]; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">rm</span> CHG CHGCAR DOSCAR IBZKPT OSZICAR REPORT WAVECAR XDATCAR vasprun.xml OUTCAR EIGENVAL PCDAT
        find . -maxdepth 1 -name <span class="hljs-string">&#x27;*.out&#x27;</span> -delete
        <span class="hljs-built_in">mv</span> POSCAR POSCAR.init
        <span class="hljs-built_in">mv</span> CONTCAR CONTCAR.init
        <span class="hljs-built_in">cp</span> CONTCAR.init POSCAR
        sed -i <span class="hljs-string">&#x27;/\bEDIFF\b/s/.*/EDIFF = 1E-5/&#x27;</span> INCAR
        sed -i <span class="hljs-string">&#x27;/\bEDIFFG\b/s/.*/EDIFFG = -0.02/&#x27;</span> INCAR
        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Updated the POSCAR successfully !&quot;</span>
<span class="hljs-keyword">elif</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$input</span>&quot;</span> = <span class="hljs-string">&quot;n&quot;</span> ]; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">rm</span> CHG CHGCAR DOSCAR IBZKPT OSZICAR REPORT WAVECAR XDATCAR vasprun.xml OUTCAR EIGENVAL PCDAT
        find . -maxdepth 1 -name <span class="hljs-string">&#x27;*.out&#x27;</span> -delete
        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Just removed the old output files !&quot;</span>
<span class="hljs-keyword">else</span>
        <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Nothing was done !&quot;</span>
<span class="hljs-keyword">fi</span>
&#125;
<span class="hljs-comment">#########################################&lt;&lt;&lt;clear-some-files&gt;&gt;&gt;###########################################</span>


<span class="hljs-comment">###########################################&lt;&lt;&lt;&lt;control-script&gt;&gt;&gt;&gt;#########################################</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;This script is for GeoOpt monitor !&quot;</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;---------------------------------------------------------                                               </span>
<span class="hljs-string">01) Energy-Force</span>
<span class="hljs-string">02) Lattice-Difference</span>
<span class="hljs-string">03) Summary-GeoOpt</span>
<span class="hljs-string">04) Mag-Variation</span>
<span class="hljs-string">05) Data-Sort</span>
<span class="hljs-string">06) Clear-Some-Files</span>
<span class="hljs-string">00) sbatch-job-monitor </span>
<span class="hljs-string">---------------------------------------------------------&quot;</span><span class="hljs-string">&quot;&quot;</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;Here you can choose the tasks as shown above ----&gt; &quot;</span>

<span class="hljs-built_in">read</span> task
<span class="hljs-keyword">case</span> <span class="hljs-variable">$task</span> <span class="hljs-keyword">in</span>
    01) f01 ;;
    02) f02 ;;
    03) f03 ;;
    04) f04 ;;
    05) f05 ;;
    06) f06 ;;
    00) f00 ;;
    *)  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;please check the inputation !&quot;</span> ;;
<span class="hljs-keyword">esac</span>
<span class="hljs-comment">###########################################&lt;&lt;&lt;&lt;control-script&gt;&gt;&gt;&gt;#########################################</span></code></pre></div>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/scripts/">scripts</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/shell/">shell</a>
                    
                  </div>
                
              </div>
              <p class="note note-warning">
                <strong>本文作者: </strong><a href="/">Uncle-yang</a> <br>
                <strong>本文链接: </strong><a href="https://uncleleiy.github.io/2023/10/25/blog-shell-vasp-script-3/">https://uncleleiy.github.io/2023/10/25/blog-shell-vasp-script-3/</a> <br>
                <strong>版权声明: </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                   </p>
                   
              
                <div class="post-prevnext row">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/11/05/blog-pictures/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Future</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/10/10/blog-shell-vasp-script-2/">
                        <span class="hidden-mobile">shell脚本：免去重复操作</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->




    
  </main>

  

  

  

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href=" " target="_blank" rel="nofollow noopener"><span>Study</span></a> <i class="iconfont icon-book"></i> <a href=" " target="_blank" rel="nofollow noopener"><span>Notes</span></a> 
  </div>
  
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


    

      

          <!-- 在网页底部添加本站已运行的时间 -->
          <span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
          <script>
            var now = new Date();
            function createtime() {
              var grt = new Date("06/06/2023 12:00:00");//在此处修改你的建站时间
              now.setTime(now.getTime() + 250);
              days = (now - grt) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
              hours = (now - grt) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
              if (String(hnum).length == 1) { hnum = "0" + hnum; } minutes = (now - grt) / 1000 / 60 - (24 * 60 * dnum) - (60 * hnum);
              mnum = Math.floor(minutes); if (String(mnum).length == 1) { mnum = "0" + mnum; }
              seconds = (now - grt) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
              snum = Math.round(seconds); if (String(snum).length == 1) { snum = "0" + snum; }
              document.getElementById("timeDate").innerHTML = "小站已勉强存活 " + dnum + " 天 ";
              document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
            }
            setInterval("createtime()", 250);
          </script>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/main.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>



  
<script src="/js/new.js"></script>




  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '#post-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>





  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "left",
      visible: "hover",
      
      icon: " ❡ "
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>
















  

  

  

  

  

  




</body>
</html>